const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/controller-D3r0oWvX.js","assets/index-DglwOhOF.js","assets/controller-D7hPsF5a.js","assets/controller-DFzdvesH.js","assets/controller-7pTBEVTu.js","assets/MenuSidebarWidget-QuozgRuq.js","assets/ButtonComponent-HQGzvG8y.js","assets/ButtonComponent-RZKq-co4.css","assets/MenuSidebarWidget-BdymGhvM.css"])))=>i.map(i=>d[i]);
import{_ as M,c as r,o as l,a as d,m as C,d as y,r as b,p as B,q as R,F as E,j as L,n as j,t as $,e as I,s as S,v as P,i as f,T as A,w as g,h as T,x as H,y as z,z as O,A as U,k as D,B as F,C as N}from"./index-DglwOhOF.js";import{M as W,u as q}from"./MenuSidebarWidget-QuozgRuq.js";import{B as x,_ as Z}from"./ButtonComponent-HQGzvG8y.js";const G={},J={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"};function K(c,n){return l(),r("svg",J,n[0]||(n[0]=[d("path",{d:"M19.325 9.46832C19.325 9.46832 18.782 16.2033 18.467 19.0403C18.317 20.3953 17.48 21.1893 16.109 21.2143C13.5 21.2613 10.888 21.2643 8.28003 21.2093C6.96103 21.1823 6.13803 20.3783 5.99103 19.0473C5.67403 16.1853 5.13403 9.46832 5.13403 9.46832",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),d("path",{d:"M20.7082 6.23981H3.75024",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),d("path",{id:"Stroke 5",d:"M17.4406 6.23979C16.6556 6.23979 15.9796 5.68479 15.8256 4.91579L15.5826 3.69979C15.4326 3.13879 14.9246 2.75079 14.3456 2.75079H10.1126C9.53358 2.75079 9.02558 3.13879 8.87558 3.69979L8.63258 4.91579C8.47858 5.68479 7.80258 6.23979 7.01758 6.23979",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const Q=M(G,[["render",K]]),X={},Y={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none"};function ee(c,n){return l(),r("svg",Y,n[0]||(n[0]=[d("path",{d:"M11.4922 2.78912H7.75324C4.67824 2.78912 2.75024 4.96612 2.75024 8.04812V16.3621C2.75024 19.4441 4.66924 21.6211 7.75324 21.6211H16.5772C19.6622 21.6211 21.5812 19.4441 21.5812 16.3621V12.3341",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),d("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M8.82763 10.921L16.3006 3.44805C17.2316 2.51805 18.7406 2.51805 19.6716 3.44805L20.8886 4.66505C21.8196 5.59605 21.8196 7.10605 20.8886 8.03605L13.3796 15.545C12.9726 15.952 12.4206 16.181 11.8446 16.181H8.09863L8.19263 12.401C8.20663 11.845 8.43363 11.315 8.82763 10.921Z",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),d("path",{d:"M15.165 4.60266L19.731 9.16866",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)]))}const te=M(X,[["render",ee]]),oe=Object.assign({"/src/services/api/controllers/auth/controller.ts":()=>C(()=>import("./index-DglwOhOF.js").then(c=>c.L),[]),"/src/services/api/controllers/chatgpt/controller.ts":()=>C(()=>import("./controller-D3r0oWvX.js"),__vite__mapDeps([0,1])),"/src/services/api/controllers/pika/controller.ts":()=>C(()=>import("./controller-D7hPsF5a.js"),__vite__mapDeps([2,1])),"/src/services/api/controllers/pixverse/controller.ts":()=>C(()=>import("./controller-DFzdvesH.js"),__vite__mapDeps([3,1])),"/src/services/api/controllers/qwen/controller.ts":()=>C(()=>import("./controller-7pTBEVTu.js"),__vite__mapDeps([4,1])),"/src/services/api/controllers/user/controller.ts":()=>C(()=>import("./MenuSidebarWidget-QuozgRuq.js").then(c=>c.c),__vite__mapDeps([5,1,6,7,8]))});async function se(c){const n=localStorage.getItem("access_token"),a=localStorage.getItem("token_type"),i=`/src/services/api/controllers/${c}/controller.ts`,o=oe[i];if(!o)throw new Error(`Controller not found for: ${c}`);const u=await o(),p=u.default||u[`${le(c)}Controller`];return new p({headers:{Authorization:`${a} ${n}`}})}function le(c){return c.charAt(0).toUpperCase()+c.slice(1)}const ne={class:"table__row table__row--body"},ae={key:1,class:"table__preview-wrapper"},re={key:1,class:"table__preview-mock"},ie={key:2,class:"table__cell-text"},ce={key:3,class:"table__cell-text"},de={class:"table__cell table__cell--actions"},_e=y({__name:"TableRowComponent",props:{row:{},headers:{}},emits:["edit","delete","open-full"],setup(c,{emit:n}){const a=c,i=n,o=b({}),u=new Set,p=[{id:1,icon:te,handler:()=>i("edit",a.row)},{id:2,icon:Q,handler:()=>i("delete",a.row)}],_=e=>btoa(e),v=e=>e.replace(/^https?:\/\/[^/]+/,""),t=new Map,m=async e=>{if(!e)return"";if(o.value[e])return o.value[e];if(t.has(e))return await t.get(e);const h=(async()=>{try{const s=await fetch(v(e));if(!s.ok)throw new Error(s.statusText);const k=await s.blob(),V=URL.createObjectURL(k);return o.value[e]=V,t.delete(e),V}catch(s){return console.error("Loading error:",e,s),t.delete(e),""}})();return t.set(e,h),await h},w=(e,h)=>{if(!e||u.has(h)||o.value[h])return;const s=new IntersectionObserver(async([k])=>{k.isIntersecting&&(e.src||(e.src=await m(h)),u.add(h),s.disconnect())},{threshold:.1});s.observe(e)};return B(()=>a.row,async()=>{await R();const e=a.row.preview_large;if(!e)return;const h=document.getElementById(_(e));h&&(o.value[e]&&(h.src=o.value[e]),!u.has(e)&&w(h,e))},{immediate:!0}),(e,h)=>(l(),r("tr",ne,[(l(!0),r(E,null,L(e.headers,s=>{var k;return l(),r("td",{key:`${a.row.id||a.row.preview_large}-${s}`,class:"table__cell table__cell--body"},[s==="is_active"?(l(),r("span",{key:0,class:j(["table__cell-status",{"table__cell-status--active":e.row[s],"table__cell-status--inactive":!e.row[s]}])},$(e.row[s]?"active":"inactive"),3)):s==="preview_large"?(l(),r("div",ae,[e.row[s]?(l(),I(S(e.row[s].endsWith(".mp4")?"video":"img"),P({key:0,class:"table__preview",id:_(e.row[s])},{ref_for:!0},e.row[s].endsWith(".mp4")?{controls:!0,preload:"metadata"}:{alt:"preview",onClick:()=>i("open-full",e.row[s])}),null,16,["id"])):(l(),r("div",re))])):["templates","styles"].includes(s)?(l(),r("p",ie,$(((k=e.row[s])==null?void 0:k.length)||0),1)):(l(),r("p",ce,$(e.row[s]),1))])}),128)),d("td",de,[(l(),r(E,null,L(p,s=>f(x,{icon:s.icon,key:s.id,type:"button",onClick:s.handler},null,8,["icon","onClick"])),64))])]))}}),ue={class:"table__content"},pe=y({__name:"TableBodyComponent",props:{data:{},headers:{}},emits:["edit","delete","open-full"],setup(c,{emit:n}){const a=n;return(i,o)=>(l(),r("tbody",ue,[(l(!0),r(E,null,L(i.data,(u,p)=>(l(),I(_e,{key:p,row:u,headers:i.headers,onEdit:o[0]||(o[0]=_=>a("edit",_)),onDelete:o[1]||(o[1]=_=>a("delete",_)),onOpenFull:o[2]||(o[2]=_=>a("open-full",_))},null,8,["row","headers"]))),128))]))}}),me={class:"table__head"},ve={class:"table__row table__row--head"},he={class:"table__cell-text"},we=y({__name:"TableHeadComponent",props:{headers:{}},setup(c){return(n,a)=>(l(),r("thead",me,[d("tr",ve,[(l(!0),r(E,null,L(n.headers,i=>(l(),r("th",{key:i,class:"table__cell table__cell--head"},[d("p",he,$(i),1)]))),128)),a[0]||(a[0]=d("th",{class:"table__cell table__cell--head table__cell--actions"}," Actions ",-1))])]))}}),fe={key:0,class:"modal__backdrop"},be={class:"modal__content"},ke={class:"modal__form"},Ce={class:"modal__label"},ge=["onUpdate:modelValue"],ye={class:"modal__actions"},$e=y({__name:"ModalComponent",props:{visible:{type:Boolean},headers:{},row:{}},emits:["close","save"],setup(c,{emit:n}){const a=c,i=n,o=b({});B(()=>a.row,v=>{v&&(o.value={...v},R(()=>_()))},{immediate:!0});function u(){i("save",o.value),i("close")}function p(v){const t=v.target;t.style.height="auto",t.style.height=t.scrollHeight+"px"}function _(){document.querySelectorAll(".modal__textarea").forEach(t=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"})}return(v,t)=>(l(),I(A,{name:"fade"},{default:g(()=>[v.visible?(l(),r("div",fe,[f(A,{name:"slide-down"},{default:g(()=>[d("div",be,[t[3]||(t[3]=d("h2",{class:"modal__title"},"Edit Data",-1)),d("div",ke,[v.key!=="id"?(l(!0),r(E,{key:0},L(o.value,(m,w)=>(l(),r("div",{key:w,class:"modal__form-field"},[d("label",Ce,$(w),1),H(d("textarea",{"onUpdate:modelValue":e=>o.value[w]=e,class:"modal__textarea",rows:1,onInput:p},null,40,ge),[[z,o.value[w]]])]))),128)):T("",!0)]),d("div",ye,[f(x,{type:"button",onClick:t[0]||(t[0]=m=>i("close")),class:"cancel-button"},{default:g(()=>t[1]||(t[1]=[O(" Cancel ")])),_:1,__:[1]}),f(x,{type:"button",onClick:u,class:"save-button"},{default:g(()=>t[2]||(t[2]=[O(" Save ")])),_:1,__:[2]})])])]),_:1})])):T("",!0)]),_:1}))}}),Ee=M($e,[["__scopeId","data-v-6cd6e035"]]),Le={class:"table"},De={key:0,class:"table__no-data"},Ie={key:1,class:"table__wrapper"},Te={class:"table__body"},xe={class:"table__scroll"},Me={class:"table__body"},Ve=["src"],Ae=y({__name:"TableWidget",props:{data:{},exclude:{}},setup(c){const n=c,a=U(()=>!n.data||n.data.length===0?[]:Object.keys(n.data[0]).filter(t=>{var m;return!((m=n.exclude)!=null&&m.includes(t))})),i=b(!1),o=b(null);function u(t){o.value=t,i.value=!0}function p(t){console.log("Удаляем:",t)}const _=b(null);function v(t){_.value=t}return(t,m)=>(l(),r("div",Le,[!t.data||t.data.length===0?(l(),r("div",De," Missing data ")):(l(),r("div",Ie,[d("table",Te,[f(D(we),{headers:a.value},null,8,["headers"])]),d("div",xe,[d("table",Me,[f(D(pe),{data:t.data,headers:a.value,onEdit:u,onDelete:p,onOpenFull:v},null,8,["data","headers"])]),_.value?(l(),r("div",{key:0,class:"fullscreen__overlay",onClick:m[0]||(m[0]=w=>_.value=null)},[d("img",{src:_.value,class:"fullscreen__image"},null,8,Ve)])):T("",!0)])])),f(Ee,{visible:i.value,headers:a.value,row:o.value||void 0,onClose:m[1]||(m[1]=w=>i.value=!1),onSave:m[2]||(m[2]=w=>console.log("Сохраняем:",w))},null,8,["visible","headers","row"])]))}}),Oe={class:"wrapper__admin"},Se=y({__name:"AdminPage",setup(c){const n=F(),a=b(null),i=b(null);async function o(){const u=n.params.title,p=n.params.subroute;!u||!p||(a.value=await se(u),i.value=q(a.value,_=>_[p].get(),`${u}_${p}`))}return N(()=>{o()}),(u,p)=>(l(),I(Z,null,{sidebar:g(()=>[f(D(W),{title:D(n).params.title},null,8,["title"])]),content:g(()=>{var _;return[d("div",Oe,[f(Ae,{data:(_=i.value)==null?void 0:_.value,exclude:["id","prompt","template_id","preview_small"]},null,8,["data"])])]}),_:1}))}});export{Se as default};
